<view class="container data-v-3308d434"><view class="room-header data-v-3308d434"><view class="room-info data-v-3308d434"><text class="room-title data-v-3308d434">{{"房间 #"+roomCode}}</text><text class="room-subtitle data-v-3308d434">{{ownerName+"的房间"}}</text></view><block wx:if="{{isOwner&&!gameStarted}}"><view data-event-opts="{{[['tap',[['showRoomQR',['$event']]]]]}}" class="room-qr data-v-3308d434" bindtap="__e"><text class="qr-icon data-v-3308d434">📱</text><text class="qr-text data-v-3308d434">邀请码</text></view></block></view><view class="score-table data-v-3308d434"><view class="table-header data-v-3308d434"><text class="header-player data-v-3308d434">玩家</text><text class="header-score data-v-3308d434">得分</text><text class="header-action data-v-3308d434">操作</text></view><view class="table-body data-v-3308d434"><block wx:for="{{players}}" wx:for-item="player" wx:for-index="__i0__" wx:key="_id"><view class="{{['player-row','data-v-3308d434',(player.userId===currentUserId)?'is-current':'']}}"><view class="player-info data-v-3308d434"><image class="player-avatar data-v-3308d434" src="{{player.avatarUrl||'/static/default-avatar.png'}}"></image><view class="player-details data-v-3308d434"><text class="player-name data-v-3308d434">{{player.nickName}}</text><block wx:if="{{player.userId===ownerId}}"><text class="player-status data-v-3308d434">房主</text></block></view></view><view class="player-score data-v-3308d434"><text class="{{['score-number','data-v-3308d434',(player.score>0)?'positive':'',(player.score<0)?'negative':'']}}">{{''+(player.score>0?'+':'')+player.score+''}}</text></view><view class="player-action data-v-3308d434"><block wx:if="{{player.userId!==currentUserId&&gameStarted}}"><button data-event-opts="{{[['tap',[['showGiveScore',['$0'],[[['players','_id',player._id]]]]]]]}}" class="give-score-btn data-v-3308d434" bindtap="__e">给分</button></block><block wx:else><text class="no-action data-v-3308d434">--</text></block></view></view></block></view></view><view class="room-controls data-v-3308d434"><button data-event-opts="{{[['tap',[['showScoreDetail',['$event']]]]]}}" class="control-btn detail-btn data-v-3308d434" bindtap="__e"><text class="btn-text data-v-3308d434">给分详情</text></button><block wx:if="{{isOwner}}"><button data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="{{['control-btn','data-v-3308d434',gameStarted?'settle-btn':'start-btn']}}" bindtap="__e"><text class="btn-text data-v-3308d434">{{gameStarted?'结算房间':'开始游戏'}}</text></button></block></view><block wx:if="{{showQRModal}}"><view data-event-opts="{{[['tap',[['closeQRModal',['$event']]]]]}}" class="qr-modal data-v-3308d434" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="qr-content data-v-3308d434" catchtap="__e"><view class="qr-header data-v-3308d434"><text class="qr-title data-v-3308d434">房间邀请码</text><text data-event-opts="{{[['tap',[['closeQRModal',['$event']]]]]}}" class="close-btn data-v-3308d434" bindtap="__e">×</text></view><view class="qr-image data-v-3308d434"><text class="qr-code data-v-3308d434">{{roomCode}}</text></view><text class="qr-tip data-v-3308d434">分享房间号给朋友，或点击下方按钮分享</text><button data-event-opts="{{[['tap',[['shareRoom',['$event']]]]]}}" class="share-btn data-v-3308d434" bindtap="__e"><text class="share-text data-v-3308d434">分享到微信</text></button></view></view></block><block wx:if="{{showGiveScoreModal}}"><view data-event-opts="{{[['tap',[['closeGiveScore',['$event']]]]]}}" class="give-score-modal data-v-3308d434" bindtap="__e"><view data-event-opts="{{[['tap',[['',['$event']]]]]}}" class="give-score-content data-v-3308d434" catchtap="__e"><view class="give-score-header data-v-3308d434"><text class="give-score-title data-v-3308d434">{{"给 "+targetPlayer.nickName+" 计分"}}</text><text data-event-opts="{{[['tap',[['closeGiveScore',['$event']]]]]}}" class="close-btn data-v-3308d434" bindtap="__e">×</text></view><view class="score-input-section data-v-3308d434"><text class="input-label data-v-3308d434">分数</text><input class="score-input data-v-3308d434" type="number" placeholder="输入分数" data-event-opts="{{[['input',[['__set_model',['','giveScoreAmount','$event',['number']]],['onScoreInput',['$event']]]],['blur',[['$forceUpdate']]]]}}" value="{{giveScoreAmount}}" bindinput="__e" bindblur="__e"/><text class="input-tip data-v-3308d434">正数为加分，负数为扣分</text></view><view class="quick-scores data-v-3308d434"><text class="quick-title data-v-3308d434">快速选择</text><view class="quick-buttons data-v-3308d434"><block wx:for="{{quickScores}}" wx:for-item="score" wx:for-index="__i1__" wx:key="*this"><button data-event-opts="{{[['tap',[['selectQuickScore',['$0'],[[['quickScores','',__i1__]]]]]]]}}" class="quick-btn data-v-3308d434" bindtap="__e">{{''+(score>0?'+':'')+score+''}}</button></block></view></view><button class="confirm-give-btn data-v-3308d434" disabled="{{!giveScoreAmount}}" data-event-opts="{{[['tap',[['confirmGiveScore',['$event']]]]]}}" bindtap="__e"><text class="confirm-text data-v-3308d434">确认给分</text></button></view></view></block></view>